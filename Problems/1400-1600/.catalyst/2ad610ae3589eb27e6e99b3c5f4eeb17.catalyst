{"title":{"en":"D. Insert a Progression","ru":"D. Вставь прогрессию"},"contestId":"1671","problemIndex":"D","timeLimit":{"en":"2 seconds","ru":"2 секунды"},"memLimit":{"en":"256 megabytes","ru":"256 мегабайт"},"inputFormat":{"en":"standard input","ru":"стандартный ввод"},"outputFormat":{"en":"standard output","ru":"стандартный вывод"},"problemHtml":{"en":"<p>You are given a sequence of $$$n$$$ integers $$$a_1, a_2, \\dots, a_n$$$. You are also given $$$x$$$ integers $$$1, 2, \\dots, x$$$.</p><p>You are asked to insert each of the extra integers into the sequence $$$a$$$. Each integer can be inserted at the beginning of the sequence, at the end of the sequence, or between any elements of the sequence.</p><p>The score of the resulting sequence $$$a'$$$ is the sum of absolute differences of adjacent elements in it $$$\\left(\\sum \\limits_{i=1}^{n+x-1} |a'_i - a'_{i+1}|\\right)$$$.</p><p>What is the smallest possible score of the resulting sequence $$$a'$$$?</p>","ru":"<p>Дана последовательность из $$$n$$$ целых чисел $$$a_1, a_2, \\dots, a_n$$$. Также даны $$$x$$$ целых чисел $$$1, 2, \\dots, x$$$.</p><p>Вас просят вставить каждое из этих дополнительных целых чисел в последовательность $$$a$$$. Каждое число можно вставлять в начало последовательности, в конец последовательности или между любыми элементами последовательности.</p><p>Счет полученной последовательности $$$a'$$$ равен сумме абсолютных разностей соседних элементов в ней $$$\\left(\\sum \\limits_{i=1}^{n+x-1} |a'_i - a'_{i+1}|\\right)$$$.</p><p>Какой наименьший счет может быть у последовательности $$$a'$$$?</p>"},"inSpecsHtml":{"en":"<div class=\"section-title\">Input</div><p>The first line contains a single integer $$$t$$$ ($$$1 \\le t \\le 10^4$$$)&nbsp;— the number of testcases.</p><p>The first line of each testcase contains two integers $$$n$$$ and $$$x$$$ ($$$1 \\le n, x \\le 2 \\cdot 10^5$$$)&nbsp;— the length of the sequence and the number of extra integers.</p><p>The second line of each testcase contains $$$n$$$ integers $$$a_1, a_2, \\dots, a_n$$$ ($$$1 \\le a_i \\le 2 \\cdot 10^5$$$).</p><p>The sum of $$$n$$$ over all testcases doesn't exceed $$$2 \\cdot 10^5$$$.</p>","ru":"<div class=\"section-title\">Входные данные</div><p>В первой строке записано одно целое число $$$t$$$ ($$$1 \\le t \\le 10^4$$$)&nbsp;— количество наборов входных данных.</p><p>В первой строке каждого набора входных данных записаны два целых числа $$$n$$$ и $$$x$$$ ($$$1 \\le n, x \\le 2 \\cdot 10^5$$$)&nbsp;— длина последовательности и количество дополнительных чисел.</p><p>Во второй строке каждого набора входных данных записаны $$$n$$$ целых чисел $$$a_1, a_2, \\dots, a_n$$$ ($$$1 \\le a_i \\le 2 \\cdot 10^5$$$).</p><p>Сумма $$$n$$$ по всем наборам входных данных не превосходит $$$2 \\cdot 10^5$$$.</p>"},"outSpecsHtml":{"en":"<div class=\"section-title\">Output</div><p>For each testcase, print a single integer&nbsp;— the smallest sum of absolute differences of adjacent elements of the sequence after you insert the extra integers into it.</p>","ru":"<div class=\"section-title\">Выходные данные</div><p>На каждый набор входных данных выведите одно целое число&nbsp;— наименьшую сумму абсолютных разностей соседних элементов в последовательности после того, как вы вставите в нее дополнительные числа.</p>"},"noteHtml":{"en":"<div class=\"section-title\">Note</div><p>Here are the sequences with the smallest scores for the example. The underlined elements are the extra integers. Note that there exist other sequences with this smallest score. </p><ul> <li> $$$\\underline{1}, \\underline{2}, \\underline{3}, \\underline{4}, \\underline{5}, 10$$$ </li><li> $$$\\underline{7}, 7, \\underline{6}, \\underline{4}, 2, \\underline{2}, \\underline{1}, \\underline{3}, \\underline{5}, \\underline{8}, 10$$$ </li><li> $$$6, \\underline{1}, 1, \\underline{2}, 5, 7, 3, 3, 9, 10, 10, 1$$$ </li><li> $$$1, 3, \\underline{1}, 1, 2, \\underline{2}, \\underline{3}, \\underline{4}, \\underline{5}, \\underline{6}, \\underline{7}, \\underline{8}, \\underline{9}, \\underline{10}$$$ </li></ul>","ru":"<div class=\"section-title\">Примечание</div><p>Здесь представлены последовательности с наименьшим счетом в примере. Подчеркнутые элементы&nbsp;— это дополнительные числа. Обратите внимание, что существуют и другие последовательности с наименьшим счетом. </p><ul> <li> $$$\\underline{1}, \\underline{2}, \\underline{3}, \\underline{4}, \\underline{5}, 10$$$ </li><li> $$$\\underline{7}, 7, \\underline{6}, \\underline{4}, 2, \\underline{2}, \\underline{1}, \\underline{3}, \\underline{5}, \\underline{8}, 10$$$ </li><li> $$$6, \\underline{1}, 1, \\underline{2}, 5, 7, 3, 3, 9, 10, 10, 1$$$ </li><li> $$$1, 3, \\underline{1}, 1, 2, \\underline{2}, \\underline{3}, \\underline{4}, \\underline{5}, \\underline{6}, \\underline{7}, \\underline{8}, \\underline{9}, \\underline{10}$$$ </li></ul>"},"sampleTestcases":[{"id":1651512489108,"input":"4\n1 5\n10\n3 8\n7 2 10\n10 2\n6 1 5 7 3 3 9 10 10 1\n4 10\n1 3 1 2\n","output":"9\n15\n31\n13\n","result":{"id":1651512489108,"stdout":"9\r\n15\r\n31\r\n13\r\n","stderr":"","exitcode":0,"signal":null,"time":34,"timeout":false}}],"submitUrl":"https://codeforces.com/problemset/submit","language":"c++","langId":"50","editorial":"<div><p>Observe the cost of inserting a single element. Notice that inserting any value between the minimum of the sequence and the maximum of the sequence is free.</p><p>Why is this true? The argument is similar to the algorithm of finding some $$$x$$$ such that $$$f(x) = 0$$$ for a continous function $$$f$$$ if you know some $$$x_1$$$ such that $$$f(x_1) &lt; 0$$$ and $$$x_2$$$ such that $$$f(x_2) &gt; 0$$$.</p><p>As a more general idea, it's free to insert some value $$$s$$$ into a segment $$$[l; r]$$$ such that $$$a_l \\le s$$$ and $$$s \\le a_r$$$ (WLOG assume $$$a_l \\le a_r$$$). Let's find the position that is free. If $$$r - l = 1$$$, then you can insert $$$s$$$ between $$$a_l$$$ and $$$a_r$$$, since it's free. Otherwise, you can choose an arbitrary position $$$l &lt; i &lt; r$$$. $$$s$$$ will be either between $$$a_i$$$ and $$$a_l$$$ or between $$$a_i$$$ and $$$a_r$$$ (or both of them). Descend into the one that holds to continue the search. Since the lenght decreases, at some point you will reach the segment of length $$$1$$$.</p><p>How does that help? Well, you can insert $$$1$$$ somewhere, then insert $$$x$$$ somewhere. The rest of insertions will be free.</p><p>Now it's an algorithmic problem. First, consider all options to insert both $$$1$$$ and $$$x$$$ between the same pair of elements. Next, assume you insert $$$1$$$ somewhere before $$$x$$$. Iterate from left to right, maintaning the lowest price to insert $$$1$$$. Try to insert $$$x$$$ at the current position and $$$1$$$ into the cheapest position before it. Then update the lowest price for inserting $$$1$$$. After you finish, reverse the sequence and solve the problem again&nbsp;— that will be the same as inserting $$$x$$$ before $$$1$$$.</p><p>Overall complexity: $$$O(n)$$$ per testcase.</p></div>"}